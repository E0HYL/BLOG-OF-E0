---
layout: post
title: 从B样条基函数到曲线到曲面
description: "有关B样条的一些知识整理"
modified: 2020-5-31
tags: [Geometric]
math: true
image:
  feature: abstract-1.jpg
---
<details open><!-- 可选open -->
<summary>Contents</summary>
<div markdown="1">
<!-- TOC -->

- [B-样条基函数](#b-%E6%A0%B7%E6%9D%A1%E5%9F%BA%E5%87%BD%E6%95%B0)
- [B-样条曲线](#b-%E6%A0%B7%E6%9D%A1%E6%9B%B2%E7%BA%BF)
    - [对比Bezier曲线](#%E5%AF%B9%E6%AF%94bezier%E6%9B%B2%E7%BA%BF)
    - [三种类型：open, clamped, closed](#%E4%B8%89%E7%A7%8D%E7%B1%BB%E5%9E%8Bopen-clamped-closed)
- [B-样条曲面](#b-%E6%A0%B7%E6%9D%A1%E6%9B%B2%E9%9D%A2)

<!-- /TOC -->
</div>
</details>

## B-样条基函数

最简单的B样条基函数是由de Boor-Cox递推公式定义的：

$$N_{i,0}(t) = \left\{\begin{matrix} 1 & t_i < t<  t_{i+1}\\ 0 & otherwise \end{matrix}\right.\\ N_{i,k} = \frac{t - t_i}{t_{i+k} - t_{i}}N_{i,k-1}(t) + \frac{t_{i+k+1} - t}{t_{i+k+1} - t_{i+1}} N_{i+1,k-1}(t)$$

其中$$t$$为节点向量，非减的实数序列：

$$t_0,t_1,...,t_{k-1},t_k,...,t_n,t_{n+1},...,t_{n+k-1},t_{n+k+1}.$$

<figure><img src="{{ site.url }}/images/B-Spline/image-20200531013126376.png" alt="image-20200531013126376" style="zoom: 75%;" /></figure>

> 加深理解：[基函数的非零区间？节点个数？](https://wlsdzyzl.top/2019/03/19/%E5%9B%BE%E5%BD%A2%E5%AD%A6%E2%80%94%E2%80%94B%E6%A0%B7%E6%9D%A1%E6%9B%B2%E7%BA%BF%E5%92%8C%E6%9B%B2%E9%9D%A2/)

<figure><img src="{{ site.url }}/images/B-Spline/image-20200531005925945.png" alt="image-20200531005925945"  /></figure>

<!--more-->

> 重要性质

- **局部支撑性 (Local Support)**

  $$N_{i,k}(t)$$是非负的，$$N_{i,k}(t)$$是$$[t_i,t_{i+k+1}]$$上的分段非零多项式：

  $$N_{i,k}(t) = \left \{ \begin{matrix} \ge 0 & t\in [t_i,t_{i+k+1}]\\ =0& otherwise \end{matrix} \right.$$

- 归一性
  区间$$[t_i,t_{i+1}]$$上的所有$$k$$次非零基函数的和为1：

  $$\sum_{i=0}^n N_{i,k}(t) = 1,t \in [t_i,t_{i+1}].$$

<figure><figure><img src="{{ site.url }}/images/B-Spline/image-20200531012646364.png" alt="image-20200531012646364" style="zoom: 75%;" /></figure><figcaption>1阶和2阶B样条基函数示例</figcaption></figure>

下图也展示了在函数定义域上的一个区间内只有k+1个基函数非0：

<figure><figure><img src="{{ site.url }}/images/B-Spline/image-20200531014433420.png" alt="image-20200531014433420" /></figure><figcaption>3阶B样条基函数示例</figcaption></figure>

## B-样条曲线

给定$$n+1$$个控制点$${P_0,P_1,…,P_n}$$,$$m+1$$个节点$$\{u_0,u_1,…,u_m\}$$, $$p$$阶B样条曲线的定义是：

$$C(u)=\sum_{i=0}^{n}N_{i,p}(u)P_i$$

<figure><img src="{{ site.url }}/images/B-Spline/image-20200531014206355.png" alt="image-20200531014206355" style="zoom: 75%;" /></figure>

### 对比Bezier曲线

>相对Bezier曲线不同之处

1. B样条的控制点个数与曲线次数无关，因此B样条的自由度更大，可以定义很多控制点又不用担心曲线次数过高而计算困难。
2. B样条有多个节点区间，使得其为分段函数，而Bezier曲线只有一个区间。

> 与Bezier曲线的联系

1. B样条上任意一个区间$$[ui,ui+1)$$上的曲线的定义都是一个Bezier。因此可以将B样条转为分段bezier曲线。
2. Bezier是一种特殊的样条曲线。

### 三种类型：open, clamped, closed

1. open: 如果节点向量没有任何特别的结构，那么产生的曲线不会与控制折线(polyline)的第一边(leg)和最后一边(leg)接触，如下面左图所示。

2. clamped: 我们可能想强制曲线使得它分别与第一个控制点和最后一个控制点的第一边和最后一边相切，像贝塞尔曲线那样。为了做到这些，第一个节点和最后一个节点必须是重复度为p+1。参见下边中间的图。

   > Clamped列表（3阶为例）：前面3+1个参数均设置为0，后面3+1个参数均设置为1，然后剩余参数均匀递增：0,0,0,0,1/3,2/3,1,1,1,1

3. closed: 通过重复某些节点和控制点，产生的曲线的开始和结尾连接在一起形成了一个闭环，如下边右图所示。

<figure><img src="{{ site.url }}/images/B-Spline/image-20200531011205169.png" alt="image-20200531011205169" style="zoom:85%;" /></figure>

## B-样条曲面

给定控制点$$P_{ij}$$以及$$U,V$$轴上的节点向量：

$$U = [u_0,u_1,...,u_{m+p}]\\ V = [v_0,v_1,...,v_{n+q}]$$

阶为$$p×q$$的B-样条曲面可以定义为：

$$P(u,v) = \sum_{i=0}^m \sum_{j=0}^n P_{ij}N_{i,p}(u)N_{j,q}(v)$$

<figure><img src="{{ site.url }}/images/B-Spline/image-20200531015100461.png" alt="image-20200531015100461" style="zoom: 70%;" /></figure>

三种类型：open, clamped, closed

>The following figures show three B-spline surfaces clamped, closed and open in both directions. All three surfaces are defined on the same set of control points; but, as in B-spline curves, their knot vectors are different.

<figure><img src="{{ site.url }}/images/B-Spline/image-20200531014040764.png" alt="image-20200531014040764" style="zoom:85%;" /></figure>



参考资料

1. [B-Spline(三)样条曲线的性质](http://www.whudj.cn/?p=493)
2. [简单粗暴：B-样条曲线入门](https://zhuanlan.zhihu.com/p/50626506)
3. [图形学——B样条曲线和曲面](https://wlsdzyzl.top/2019/03/19/%E5%9B%BE%E5%BD%A2%E5%AD%A6%E2%80%94%E2%80%94B%E6%A0%B7%E6%9D%A1%E6%9B%B2%E7%BA%BF%E5%92%8C%E6%9B%B2%E9%9D%A2/)
4. [CS3621 Introduction to Computing with Geometry Notes](https://pages.mtu.edu/~shene/COURSES/cs3621/NOTES/)